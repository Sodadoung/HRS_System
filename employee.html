<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataTables Example</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        body {
            margin: 20px;
        }

        /* Custom modal styles */
        .modal-content {
            width: 100%;
            background-color: #fefefe;
            border: 1px solid #ffffff;
        }

        .action-buttons button {
            padding: 5px 12px;
            margin: 0 2px; /* Added for spacing */
        }

        .table th {
            background-color: #212521;
            color: white;
        }

        .id-column {
            display: flex;
            align-items: center;
        }

        .btn-circle {
            width: 24px;
            height: 24px;
            padding: 0;
            border-radius: 50%;
            text-align: center;
            line-height: 24px; /* Center text vertically */
            margin-right: 5px; /* Space between button and ID */
        }

        .btn-circle.active {
            background-color: red;
            border: none;
        }
        .label{
            font-weight: bold;
            color: red;
            
        }
    </style>
</head>

<body>
    <div class="contain" >
        <h2 class="mt-4">Employee Data</h2>
        <button id="addEmployeeBtn" class="btn btn-primary mb-3">Add Employee</button>
        <table id="example" class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Last Name</th>
                    <th>First Name</th>
                    <th>Birthdate</th>
                    <th>Gender</th>
                    <th>Hire Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                <!-- Data rows added dynamically -->
            </tbody>
        </table>
        <!-- Modal for Employee Details -->
        <div id="employeeModal" class="modal fade " tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog modal-xl">
                <div class="modal-content" name="submit-to-google-sheet">
                    <div class="modal-header">
                        <h5 id="modalTitle">Add Employee</h5>
                        <button type="button" class="btn-close" id="closeModal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-3">
                                    <label for="lastName">Last Name:</label>
                                    <input type="text" name="Last Name" id="lastName" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="firstName">First Name:</label>
                                    <input type="text" name="First Name" id="firstName" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="birthdate">Birthdate:</label>
                                    <input type="date" name="Birthdate" id="birthdate" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                     <label for="gender">Gender:</label>
                                    <select id="gender" name="Gender" class="form-select" >
                                        <option value="">Select Gender</option>
                                        <option value="Male">Male</option>
                                        <option value="Female">Female</option>
                                        <option value="Other">Other</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="hireDate">Hire Date:</label>
                                    <input type="date" name="Hire Date" id="hireDate" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                    <label for="religion">Religion:</label>
                                    <input type="text" id="religion" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="maritalStatus">Marital Status:</label>
                                    <input type="text" name="Marital Status" id="maritalStatus" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="email">Email:</label>   
                                    <input type="email" name="Email" id="email" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="phone">Phone:</label>
                                    <input type="text" name="Phone" id="phone" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="role">Role:</label>
                                    <input type="text" name="Role" id="role" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="position">Position:</label>
                                    <input type="text" name="Position" id="position" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="dependents">Dependents:</label>
                                    <input type="number" name="Dependents" id="dependents" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                    <label for="birthPlace">Birth Place:</label>
                                    <input type="text" name="Birth Place" id="birthPlace" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="firstLanguage">First Language:</label>
                                    <input type="text" name="First Language" id="firstLanguage" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="secondLanguage">Second Language:</label>
                                    <input type="text" name="Second Language" id="secondLanguage" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="degree">Degree:</label>
                                    <input type="text" name="Degree" id="degree" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="passportNumber">Passport Number:</label>
                                    <input type="text" name="Passport Number" id="passportNumber" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="idNumber">ID Number:</label>
                                    <input type="text" name="ID Number" id="idNumber" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="workPermitNumber">Work Permit Number:</label>
                                    <input type="text" name="Work Permit Number" id="workPermitNumber" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="medicalInsuranceNumber">Medical Insurance Number:</label>
                                    <input type="text" name="Medical Insurance Number" id="medicalInsuranceNumber" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="referenceNumber">Reference Number:</label>
                                    <input type="text" name="Reference Number" id="referenceNumber" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="foreigner">Foreigner:</label>
                                    <select id="foreigner" name="Foreigner" class="form-select" >
                                        <option value="">Select Yes/No</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="smoker">Smoker:</label>
                                    <select id="smoker" name="Smoker" class="form-select" >
                                        <option value="">Select Yes/No</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="disability">Disability:</label>
                                    <select id="disability" name="Disability" class="form-select" >
                                        <option value="">Select Yes/No</option>
                                        <option value="Yes">Yes</option>
                                        <option value="No">No</option>
                                    </select>
                                </div>
                                <div class="col-md-3">
                                    <label for="entity">Entity:</label>
                                    <input type="text" name="Entity" id="entity" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="supervisor">Supervisor:</label>
                                    <input type="text" name="Supervisor" id="supervisor" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="employeeType">Employee Type:</label>
                                    <input type="text" name="Employee Type" id="employeeType" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="job">Job:</label>
                                    <input type="text" name="Job" id="job" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="workCalendar">Work Calendar:</label>
                                    <input type="text" name="Work Calendar" id="workCalendar" class="form-control"  autocomplete="off">
                                </div>
                                <div class="col-md-3">
                                    <label for="seniorityDate">Seniority Date:</label>
                                    <input type="date" name="Seniority Date" id="seniorityDate" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                    <label for="effectiveDate">Effective Date:</label>
                                    <input type="date" name="Effective Date" id="effectiveDate" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                    <label for="jobExpiryDate">Job Expiry Date:</label>
                                    <input type="date" name="Job Expiry Date" id="jobExpiryDate" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                    <label for="careerStartDate">Career Start Date:</label>
                                    <input type="date" name="Career Start Date" id="careerStartDate" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                    <label for="workingAgeDate">Working Age Date:</label>
                                    <input type="date" name="Working Age Date" id="workingAgeDate" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                    <label for="lastReviseDate">Last Revise Date:</label>
                                    <input type="date" name="Last Revise Date" id="lastReviseDate" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                    <label for="terminationDate">Termination Date:</label>
                                    <input type="date" name="Termination Date" id="terminationDate" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                    <label for="lastHireDate">Last Hire Date:</label>
                                    <input type="date" name="Last Hire Date" id="lastHireDate" class="form-control" >
                                </div>
                                <div class="col-md-3">
                                    <label for="laborContractSign">Labor Contract Sign:</label>
                                    <input type="text" name="Labor Contract Sign" id="laborContractSign" class="form-control"  autocomplete="off">
                                </div>
                                
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="submitEmployee" type="submit" class="btn btn-primary">Add Employee</button>
                        <button id="updateEmployee" class="btn btn-warning" style="display: none;">Update Employee</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentEmployeeIndex = null;
        let employeeIdCounter = getEmployeeIdCounter(); // Get the counter from localStorage
        let employeeDataTable; // Declare variable for DataTable instance

        // Function to get the employee ID counter from localStorage
        function getEmployeeIdCounter() {
            return parseInt(localStorage.getItem('employeeIdCounter')) || 1;
        }

        // Function to load employees from local storage
        function loadEmployees() {
            const employees = JSON.parse(localStorage.getItem('employees')) || [];
            const tableBody = $('#example tbody');
            tableBody.empty();
            employees.forEach((employee, index) => {
                tableBody.append(`
                    <tr>
                        <td>${employee.id}</td>
                        <td>${employee.lastName}</td>
                        <td>${employee.firstName}</td>
                        <td>${employee.birthdate}</td>
                        <td>${employee.gender}</td>
                        <td>${employee.hireDate}</td>

                        <td class="action-buttons">
                            <button onclick="viewEmployee(${index})" class="btn btn-info btn-sm">View</button>
                            <button onclick="editEmployee(${index})" class="btn btn-warning btn-sm">Edit</button>
                            <button onclick="deleteEmployee(${index})" class="btn btn-danger btn-sm">Delete</button>
                        </td>
                    </tr>
                `);
                // tableBody.append(`
                //     <tr>
                //         <td class="id-column">
                //             <button class="btn btn-outline-primary btn-circle btn-sm toggle-details">+</button>
                //             ${employee.id}
                //         </td>
                //         <td>${employee.lastName}</td>
                //         <td>${employee.firstName}</td>
                //         <td>${employee.birthdate}</td>
                //         <td>${employee.gender}</td>
                //         <td>${employee.hireDate}</td>
                //         <td>${employee.religion}</td>

                //         <td class="action-buttons">
                //             <button onclick="viewEmployee(${index})" class="btn btn-info btn-sm">View</button>
                //             <button onclick="editEmployee(${index})" class="btn btn-warning btn-sm">Edit</button>
                //             <button onclick="deleteEmployee(${index})" class="btn btn-danger btn-sm">Delete</button>
                //         </td>
                //     </tr>
                // `);
            });

            // Reinitialize DataTable to refresh the data and events
            if ($.fn.dataTable.isDataTable('#example')) {
                employeeDataTable.clear().rows.add($(tableBody).find('tr')).draw();
            } else {
                employeeDataTable = $('#example').DataTable({
                    columnDefs: [
                        { orderable: false, targets: 6 },
                    ],
                });
            }
        }

        // Toggle row details
        $('#example').on('click', '.toggle-details', function () {
            const tr = $(this).closest('tr');
            const row = $('#example').DataTable().row(tr);

            if (row.child.isShown()) {
                row.child.hide();
                $(this).removeClass('active btn-danger').addClass('btn-outline-primary');
                $(this).html('+');
            } else {
                row.child(formatDetails(row.data())).show();
                $(this).addClass('active btn-danger').removeClass('btn-outline-primary');
                $(this).html('<span style="color: white;">−</span>');
            }
        });

        // Format details for row
        // function formatDetails(data) {
        //     return `
        //         <div>
        //             <p><strong>Email:</strong> ${data[8]}</p>
        //             <p><strong>Phone:</strong> ${data[9]}</p>
        //             <p><strong>Role:</strong> ${data[10]}</p>
        //             <p><strong>Position:</strong> ${data[11]}</p>
        //             <p><strong>Dependents:</strong> ${data[12]}</p>
        //             <p><strong>Birth Place:</strong> ${data[13]}</p>
        //             <p><strong>First Language:</strong> ${data[14]}</p>
        //             <p><strong>Second Language:</strong> ${data[15]}</p>
        //             <p><strong>Degree:</strong> ${data[16]}</p>
        //             <p><strong>Passport Number:</strong> ${data[17]}</p>
        //             <p><strong>ID Number:</strong> ${data[18]}</p>
        //             <p><strong>Work Permit Number:</strong> ${data[19]}</p>
        //             <p><strong>Medical Insurance Number:</strong> ${data[20]}</p>
        //             <p><strong>Reference Number:</strong> ${data[21]}</p>
        //             <p><strong>Foreigner:</strong> ${data[22]}</p>
        //             <p><strong>Smoker:</strong> ${data[23]}</p>
        //             <p><strong>Disability:</strong> ${data[24]}</p>
        //             <p><strong>Entity:</strong> ${data[25]}</p>
        //             <p><strong>Supervisor:</strong> ${data[26]}</p>
        //             <p><strong>Employee Type:</strong> ${data[27]}</p>
        //             <p><strong>Job:</strong> ${data[28]}</p>
        //             <p><strong>Work Calendar:</strong> ${data[29]}</p>
        //             <p><strong>Seniority Date:</strong> ${data[30]}</p>
        //             <p><strong>Effective Date:</strong> ${data[31]}</p>
        //             <p><strong>Job Expiry Date:</strong> ${data[32]}</p>
        //             <p><strong>Career Start Date:</strong> ${data[33]}</p>
        //             <p><strong>Working Age Date:</strong> ${data[34]}</p>
        //             <p><strong>Last Revise Date:</strong> ${data[35]}</p>
        //             <p><strong>Termination Date:</strong> ${data[36]}</p>
        //             <p><strong>Last Hire Date:</strong> ${data[37]}</p>
        //             <p><strong>Labor Contract Sign:</strong> ${data[38]}</p>

        //         </div>
        //     `;
        // }

        // Function to view employee details
        function viewEmployee(index) {
            const employees = JSON.parse(localStorage.getItem('employees')) || [];
            const employee = employees[index];

            $('#modalTitle').text('View Employee');
            $('#lastName').val(employee.lastName).prop('readonly', true);
            $('#firstName').val(employee.firstName).prop('readonly', true);
            $('#birthdate').val(employee.birthdate).prop('readonly', true);
            $('#gender').val(employee.gender).prop('readonly', true);
            $('#hireDate').val(employee.hireDate).prop('readonly', true);
            $('#religion').val(employee.religion).prop('readonly', true);
            $('#maritalStatus').val(employee.maritalStatus).prop('readonly', true);
            $('#email').val(employee.email).prop('readonly', true);
            $('#phone').val(employee.phone).prop('readonly', true);
            $('#role').val(employee.role).prop('readonly', true);
            $('#position').val(employee.position).prop('readonly', true);
            $('#dependents').val(employee.dependents).prop('readonly', true);
            $('#birthPlace').val(employee.birthPlace).prop('readonly', true);
            $('#firstLanguage').val(employee.firstLanguage).prop('readonly', true);
            $('#secondLanguage').val(employee.secondLanguage).prop('readonly', true);
            $('#degree').val(employee.degree).prop('readonly', true);
            $('#passportNumber').val(employee.passportNumber).prop('readonly', true);
            $('#idNumber').val(employee.idNumber).prop('readonly', true);
            $('#workPermitNumber').val(employee.workPermitNumber).prop('readonly', true);
            $('#medicalInsuranceNumber').val(employee.medicalInsuranceNumber).prop('readonly', true);
            $('#referenceNumber').val(employee.referenceNumber).prop('readonly', true);
            $('#foreigner').val(employee.foreigner).prop('readonly', true);
            $('#smoker').val(employee.smoker).prop('readonly', true);
            $('#disability').val(employee.disability).prop('readonly', true);
            $('#entity').val(employee.entity).prop('readonly', true);
            $('#supervisor').val(employee.supervisor).prop('readonly', true);
            $('#employeeType').val(employee.employeeType).prop('readonly', true);
            $('#job').val(employee.job).prop('readonly', true);
            $('#workCalendar').val(employee.workCalendar).prop('readonly', true);
            $('#seniorityDate').val(employee.seniorityDate).prop('readonly', true);
            $('#effectiveDate').val(employee.effectiveDate).prop('readonly', true);
            $('#jobExpiryDate').val(employee.jobExpiryDate).prop('readonly', true);
            $('#careerStartDate').val(employee.careerStartDate).prop('readonly', true);
            $('#workingAgeDate').val(employee.workingAgeDate).prop('readonly', true);
            $('#lastReviseDate').val(employee.lastReviseDate).prop('readonly', true);
            $('#terminationDate').val(employee.terminationDate).prop('readonly', true);
            $('#lastHireDate').val(employee.lastHireDate).prop('readonly', true);
            $('#laborContractSign').val(employee.laborContractSign).prop('readonly', true);

            $('#submitEmployee').hide();
            $('#updateEmployee').hide();
            showModal();
        }

        // Function to edit employee details
        function editEmployee(index) {
            const employees = JSON.parse(localStorage.getItem('employees')) || [];
            currentEmployeeIndex = index;
            const employee = employees[index];

            $('#modalTitle').text('Edit Employee');
            $('#lastName').val(employee.lastName).prop('readonly', false);
            $('#firstName').val(employee.firstName).prop('readonly', false);
            $('#birthdate').val(employee.birthdate).prop('readonly', false);
            $('#gender').val(employee.gender).prop('readonly', false);
            $('#hireDate').val(employee.hireDate).prop('readonly', false);
            $('#religion').val(employee.religion).prop('readonly', false);
            $('#maritalStatus').val(employee.maritalStatus).prop('readonly', false);
            $('#email').val(employee.email).prop('readonly', false);
            $('#phone').val(employee.phone).prop('readonly', false);
            $('#role').val(employee.role).prop('readonly', false);
            $('#position').val(employee.position).prop('readonly', false);
            $('#dependents').val(employee.dependents).prop('readonly', false);
            $('#birthPlace').val(employee.birthPlace).prop('readonly', false);
            $('#firstLanguage').val(employee.firstLanguage).prop('readonly', false);
            $('#secondLanguage').val(employee.secondLanguage).prop('readonly', false);
            $('#degree').val(employee.degree).prop('readonly', false);
            $('#passportNumber').val(employee.passportNumber).prop('readonly', false);
            $('#idNumber').val(employee.idNumber).prop('readonly', false);
            $('#workPermitNumber').val(employee.workPermitNumber).prop('readonly', false);
            $('#medicalInsuranceNumber').val(employee.medicalInsuranceNumber).prop('readonly', false);
            $('#referenceNumber').val(employee.referenceNumber).prop('readonly', false);
            $('#foreigner').val(employee.foreigner).prop('readonly', false);
            $('#smoker').val(employee.smoker).prop('readonly', false);
            $('#disability').val(employee.disability).prop('readonly', false);
            $('#entity').val(employee.entity).prop('readonly', false);
            $('#supervisor').val(employee.supervisor).prop('readonly', false);
            $('#employeeType').val(employee.employeeType).prop('readonly', false);
            $('#job').val(employee.job).prop('readonly', false);
            $('#workCalendar').val(employee.workCalendar).prop('readonly', false);
            $('#seniorityDate').val(employee.seniorityDate).prop('readonly', false);
            $('#effectiveDate').val(employee.effectiveDate).prop('readonly', false);
            $('#jobExpiryDate').val(employee.jobExpiryDate).prop('readonly', false);
            $('#careerStartDate').val(employee.careerStartDate).prop('readonly', false);
            $('#workingAgeDate').val(employee.workingAgeDate).prop('readonly', false);
            $('#lastReviseDate').val(employee.lastReviseDate).prop('readonly', false);
            $('#terminationDate').val(employee.terminationDate).prop('readonly', false);
            $('#lastHireDate').val(employee.lastHireDate).prop('readonly', false);
            $('#laborContractSign').val(employee.laborContractSign).prop('readonly', false);

            $('#submitEmployee').hide();
            $('#updateEmployee').show();
            showModal();
        }

        // Function to delete an employee from the list
        function deleteEmployee(index) {
            const employees = JSON.parse(localStorage.getItem('employees')) || [];

            // SweetAlert for confirmation
            Swal.fire({
                title: 'Are you sure?',
                text: "You want to delete this employee!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, delete it!'
            }).then((result) => {
                if (result.isConfirmed) {
                    employees.splice(index, 1);
                    localStorage.setItem('employees', JSON.stringify(employees));
                    loadEmployees();
                    Swal.fire('Deleted!', 'Employee has been deleted.', 'success');
                }
            });
        }

        // Show the modal
        function showModal() {
            $('#employeeModal').modal('show');
        }

        // Hide the modal
        function closeModal() {
            $('#employeeModal').modal('hide');
            $('#lastName').val('');
            $('#firstName').val('');
            $('#birthdate').val('');
            $('#gender').val('');
            $('#hireDate').val('');
            $('#religion').val('');
            $('#maritalStatus').val('');
            $('#email').val('');
            $('#phone').val('');
            $('#role').val('');
            $('#position').val('');
            $('#dependents').val('');
            $('#birthPlace').val('');
            $('#firstLanguage').val('');
            $('#secondLanguage').val('');
            $('#degree').val('');
            $('#passportNumber').val('');
            $('#idNumber').val('');
            $('#workPermitNumber').val('');
            $('#medicalInsuranceNumber').val('');
            $('#referenceNumber').val('');
            $('#foreigner').val('');
            $('#smoker').val('');
            $('#disability').val('');
            $('#entity').val('');
            $('#supervisor').val('');
            $('#employeeType').val('');
            $('#job').val('');
            $('#workCalendar').val('');
            $('#seniorityDate').val('');
            $('#effectiveDate').val('');
            $('#jobExpiryDate').val('');
            $('#careerStartDate').val('');
            $('#workingAgeDate').val('');
            $('#lastReviseDate').val('');
            $('#terminationDate').val('');
            $('#lastHireDate').val('');
            $('#laborContractSign').val('');
        }

        // Add employee to local storage with ID
        function addEmployee() {
            const lastName = $('#lastName').val();
            const firstName = $('#firstName').val();
            const birthdate = $('#birthdate').val();
            const gender = $('#gender').val();
            const hireDate = $('#hireDate').val();
            const religion = $('#religion').val();
            const maritalStatus = $('#maritalStatus').val();
            const email = $('#email').val();
            const phone = $('#phone').val();
            const role = $('#role').val();
            const position = $('#position').val();
            const dependents = $('#dependents').val();
            const birthPlace = $('#birthPlace').val();
            const firstLanguage = $('#firstLanguage').val();
            const secondLanguage = $('#secondLanguage').val();
            const degree = $('#degree').val();
            const passportNumber = $('#passportNumber').val();
            const idNumber = $('#idNumber').val();
            const workPermitNumber = $('#workPermitNumber').val();
            const medicalInsuranceNumber = $('#medicalInsuranceNumber').val();
            const referenceNumber = $('#referenceNumber').val();
            const foreigner = $('#foreigner').val();
            const smoker = $('#smoker').val();
            const disability = $('#disability').val();
            const entity = $('#entity').val();
            const supervisor = $('#supervisor').val();
            const employeeType = $('#employeeType').val();
            const job = $('#job').val();
            const workCalendar = $('#workCalendar').val();
            const seniorityDate = $('#seniorityDate').val();
            const effectiveDate = $('#effectiveDate').val();
            const jobExpiryDate = $('#jobExpiryDate').val();
            const careerStartDate = $('#careerStartDate').val();
            const workingAgeDate = $('#workingAgeDate').val();
            const lastReviseDate = $('#lastReviseDate').val();
            const terminationDate = $('#terminationDate').val();
            const lastHireDate = $('#lastHireDate').val();
            const laborContractSign = $('#laborContractSign').val();

            if (lastName && firstName && birthdate && gender && religion && maritalStatus && email && phone && role && position && dependents && birthPlace && firstLanguage && secondLanguage && degree) {
                const employees = JSON.parse(localStorage.getItem('employees')) || [];
                const newEmployee = { id: employeeIdCounter++, lastName, firstName, birthdate, gender, hireDate, religion, maritalStatus, email, phone, role, position, dependents, birthPlace, firstLanguage, secondLanguage, degree};
                employees.push(newEmployee);
                localStorage.setItem('employees', JSON.stringify(employees));
                
                loadEmployees(); // Refresh the table

                // Update the employeeIdCounter in localStorage
                localStorage.setItem('employeeIdCounter', employeeIdCounter);

                closeModal();

                // Show success alert
                Swal.fire({
                    icon: 'success',
                    title: 'Added!',
                    text: 'Employee has been added successfully.'
                });
            } else {
                Swal.fire({
                    icon: 'error',
                    title: 'Oops...',
                    text: 'All fields are required!'
                });
            }
        }

        // Update employee information with SweetAlert confirmation
        function updateEmployee() {
            const employees = JSON.parse(localStorage.getItem('employees')) || [];
            const lastName = $('#lastName').val();
            const firstName = $('#firstName').val();
            const birthdate = $('#birthdate').val();
            const gender = $('#gender').val();
            const hireDate = $('#hireDate').val();
            const religion = $('#religion').val();
            const maritalStatus = $('#maritalStatus').val();
            const email = $('#email').val();
            const phone = $('#phone').val();
            const role = $('#role').val();
            const position = $('#position').val();
            const dependents = $('#dependents').val();
            const birthPlace = $('#birthPlace').val();
            const firstLanguage = $('#firstLanguage').val();
            const secondLanguage = $('#secondLanguage').val();
            const degree = $('#degree').val();
            const passportNumber = $('#passportNumber').val();
            const idNumber = $('#idNumber').val();
            const workPermitNumber = $('#workPermitNumber').val();
            const medicalInsuranceNumber = $('#medicalInsuranceNumber').val();
            const referenceNumber = $('#referenceNumber').val();
            const foreigner = $('#foreigner').val();
            const smoker = $('#smoker').val();
            const disability = $('#disability').val();
            const entity = $('#entity').val();
            const supervisor = $('#supervisor').val();
            const employeeType = $('#employeeType').val();
            const job = $('#job').val();
            const workCalendar = $('#workCalendar').val();
            const seniorityDate = $('#seniorityDate').val();
            const effectiveDate = $('#effectiveDate').val();
            const jobExpiryDate = $('#jobExpiryDate').val();
            const careerStartDate = $('#careerStartDate').val();
            const workingAgeDate = $('#workingAgeDate').val();
            const lastReviseDate = $('#lastReviseDate').val();
            const terminationDate = $('#terminationDate').val();
            const lastHireDate = $('#lastHireDate').val();
            const laborContractSign = $('#laborContractSign').val();

            // SweetAlert for confirmation
            Swal.fire({
                title: 'Are you sure?',
                text: "You want to update this employee's information!",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Yes, update it!'
            }).then((result) => {
                if (result.isConfirmed) {
                    if (lastName && firstName && birthdate && gender && hireDate && religion && maritalStatus && email && phone && role && position && dependents && birthPlace && firstLanguage && secondLanguage && degree && passportNumber && idNumber && workPermitNumber && medicalInsuranceNumber && referenceNumber && foreigner && smoker && disability && entity && supervisor && employeeType && job && workCalendar && seniorityDate && effectiveDate && jobExpiryDate && careerStartDate && workingAgeDate && lastReviseDate && terminationDate && lastHireDate && laborContractSign) {
                        employees[currentEmployeeIndex] = { id: employees[currentEmployeeIndex].id, lastName, firstName, birthdate, gender, hireDate, religion, maritalStatus, email, phone, role, position, dependents, birthPlace, firstLanguage, secondLanguage, degree, passportNumber, idNumber, workPermitNumber, medicalInsuranceNumber, referenceNumber, foreigner, smoker, disability, entity, supervisor, employeeType, job, workCalendar, seniorityDate, effectiveDate, jobExpiryDate, careerStartDate, workingAgeDate, lastReviseDate, terminationDate, lastHireDate, laborContractSign };
                        localStorage.setItem('employees', JSON.stringify(employees));
                        loadEmployees();
                        closeModal();
                        Swal.fire('Updated!', 'Employee information has been updated.', 'success');
                    } else {
                        Swal.fire({
                            icon: 'error',
                            title: 'Oops...',
                            text: 'All fields are required!'
                        });
                    }
                }
            });
        }
        $(document).ready(function () {
            $('#addEmployeeBtn').click(function () {
                $('#modalTitle').text('Add Employee');
                $('#lastName').val(''); 
                $('#firstName').val('');
                $('#birthdate').val('');
                $('#gender').val('');
                $('#hireDate').val('');
                $('#religion').val('');
                $('#maritalStatus').val('');
                $('#email').val('');
                $('#phone').val('');
                $('#role').val('');
                $('#position').val('');
                $('#dependents').val('');
                $('#birthPlace').val('');
                $('#firstLanguage').val('');
                $('#secondLanguage').val('');
                $('#degree').val('');
                $('#passportNumber').val('');
                $('#idNumber').val('');
                $('#workPermitNumber').val('');
                $('#medicalInsuranceNumber').val('');
                $('#referenceNumber').val('');
                $('#foreigner').val('');
                $('#smoker').val('');
                $('#disability').val('');
                $('#entity').val('');
                $('#supervisor').val('');
                $('#employeeType').val('');
                $('#job').val('');
                $('#workCalendar').val('');
                $('#seniorityDate').val('');
                $('#effectiveDate').val('');
                $('#jobExpiryDate').val('');
                $('#careerStartDate').val('');
                $('#workingAgeDate').val('');
                $('#lastReviseDate').val('');
                $('#terminationDate').val('');
                $('#lastHireDate').val('');
                $('#laborContractSign').val('');
                $('#submitEmployee').show(); 
                $('#updateEmployee').hide(); 
                showModal();
            });
            $('#closeModal').click(closeModal);
            $('#submitEmployee').click(addEmployee);
            $('#updateEmployee').click(updateEmployee);
            loadEmployees();
        });

        // Close modal when clicking outside of it
        $(window).click(function (event) {
            if ($(event.target).is('#employeeModal')) {
                closeModal();
            }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js"></script>
</body>
<!-- send data to google sheet -->
<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycby07KUo0hrAM7SjxHsk5OgdnnZNumIPlsdM4dRPwH5bc1G7w-Q_cqnY7ltF3cmLxOIa/exec'; // Replace 'Your URL will be here' with the URL of your Google Apps Script
    const form = document.forms['submit-to-google-sheet'];
    form.addEventListener('submit', e => {
      e.preventDefault();
      fetch(scriptURL, { method: 'POST', body: new FormData(form) })
        .then(response => console.log('Success!', response))
        .catch(error => console.error('Error!', error.message));
    });
  </script>
</html>